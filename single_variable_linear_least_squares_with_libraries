import numpy as np
import matplotlib.pyplot as plt  # To visualize
import pandas as pd  # To read data
import statsmodels.api as sm

from sklearn.linear_model import LinearRegression
from sklearn import metrics

# Input

data = pd.read_csv('data.csv', sep = ',')
x = data[['SAT']]
y = data['GPA']

# Output

# Create Linear Regression (y = bo + b1 * x + e)

linear_regression = LinearRegression()  # create object for the class

# Perform linear regression

linear_regression.fit(x, y)  # perform linear regression

# Determine coefficients bo and b1

b0 = linear_regression.intercept_
b1 = linear_regression.coef_

# Summary table

summary_table = sm.OLS(y, sm.add_constant(x)).fit().summary()

# Make predictions for y

y_predicted = linear_regression.predict(x)

# Model metrics

R_squared = linear_regression.score(x, y)
mean_squared_error = metrics.mean_squared_error(y, y_predicted)
root_mean_squared_error = mean_squared_error ** 0.5
mean_absolute_error = metrics.mean_absolute_error(y, y_predicted)

# Plotting

plt.scatter(x, y)
plt.plot(x, y_predicted, color = 'red')
plt.show()

# Results

print('bo = ', b0)
print('b1 = ', b1)
print('RÂ² = ', R_squared)
print('mean_squared_error = ', mean_squared_error)
print('mean_absolute_error = ', mean_absolute_error)
print('root_mean_squared_error = ', root_mean_squared_error)
print('y_predicted = ', y_predicted)
print(summary_table)
